{% extends "base.html" %}
{% load static %}

{% block title %}Шутки и Генератор Форм{% endblock %}

{% block extra_css %}
    {{ block.super }}
    <style>
        #generator-controls { margin: 20px 0; }
        .generated-element-wrapper {
            border: 1px solid #ccc;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            display: flex;
            gap: 20px;
            align-items: flex-start;
            background-color: #f9f9f9;
        }
        .control-panel {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 10px;
            align-items: center;
        }
        .control-panel label { text-align: right; }
        .generated-checkbox-display {
            padding: 20px;
            border-left: 1px solid #eee;
        }
        .dark-mode .generated-element-wrapper {
            background-color: #2c2c2c;
            border-color: #555;
        }
        .delete-btn {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
{% endblock %}


{% block content %}
<main>
    <section class="random-joke" aria-label="Случайная шутка">
        <header>
            <h2>Random Joke:</h2>
        </header>
        <p>{{ random_joke }}</p>
    </section>

    {% if user.is_authenticated and user.is_staff %}
    <header>
        <h1>Генератор Элементов Формы</h1>
    </header>

    <section id="generator-controls">
        <label>
            <input type="checkbox" id="generator-checkbox">
            Добавить новый Checkbox
        </label>
    </section>

    <section id="generated-elements-container"></section>
    {% endif %}

    <hr>

    <header>
        <h1>Управление Студентами</h1>
    </header>

    <section id="student-form-section">
        <h2>Добавить студента</h2>
        <form id="add-student-form">
            <input type="text" id="lastName" placeholder="Фамилия" required>
            <input type="text" id="firstName" placeholder="Имя" required>
            <input type="text" id="patronymic" placeholder="Отчество" required>
            <select id="gender" required>
                <option value="male">Мужской</option>
                <option value="female">Женский</option>
            </select>
            <input type="number" id="age" placeholder="Возраст" min="16" max="35" required>
            <input type="number" id="course" placeholder="Курс" min="1" max="5" required>
            <button type="submit">Добавить</button>
        </form>
    </section>

    <section id="student-list-section">
        <h2>Список студентов</h2>
        <div id="student-list"></div>
    </section>

    <section id="result-section">
        <h2>Результат</h2>
        <button id="calculate-button">Найти курс с наибольшим % мужчин</button>
        <div id="result-container"></div>
    </section>

    <hr>

    <header>
        <h1>График функции</h1>
    </header>

    <section id="chart-section">
        <div class="chart-controls">
            <label for="x-input">X (|x| < 1):</label>
            <input type="number" id="x-input" step="0.1" value="0.5">
            <label for="eps-input">Epsilon (0 < eps < 1):</label>
            <input type="number" id="eps-input" step="0.001" value="0.01">
            <button id="generate-chart">Построить график</button>
            <button id="save-chart">Сохранить как PNG</button>
        </div>
        <div class="chart-container" style="position: relative; height:40vh; width:80vw">
            <canvas id="function-chart"></canvas>
        </div>
    </section>

</main>
{% endblock %}

{% block extra_js %}
    <script src="{% static 'js/form_generator.js' %}"></script>
    <script src="{% static 'js/students.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{% static 'js/chart_logic.js' %}"></script>
{% endblock %}
